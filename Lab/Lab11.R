# Question 15
# a)

X15a = c(486, 537, 513, 583, 453, 510, 570, 500, 458, 555, 618, 327, 350, 643, 500, 497, 421, 505, 637, 599, 392, 574, 492, 635, 460, 696, 593, 422, 499, 524, 539, 339, 472, 427, 532, 470, 417, 437, 388, 481, 537, 489, 418, 434, 466, 464, 544, 475, 608, 444, 573, 611, 586, 613, 645, 540, 494, 532, 691, 478, 513, 583, 457, 612, 628, 516, 452, 501, 453, 643, 541, 439, 627, 619, 617, 394, 607, 502, 395, 470, 531, 526, 496, 561, 491, 380, 345, 274, 672, 509)
X_S_mean = mean(X15a)
X_S_sd = sd (X15a)

# b)
b=c(0, seq(374,624,50), 1000)
T=table(cut(X15a, breaks=b))
T
O = as.numeric(T)
O

# c)
p = seq(1,7)
for (k in 1:7) {
  p[k]=pnorm(b[k+1],X_S_mean,X_S_sd)-pnorm(b[k],X_S_mean,X_S_sd)
}
E = p*length(X15a)
C=sum((O-E)^2/E)
d1 = length(T)
qchisq(0.95, d1-3)
1-pchisq(C,d1-3)
cbind(O,E)

# d)
chisquared = chisq.test(O,p=p)
pchisq(chisquared$statistic,df=d1-3)

